#課題1
https://gyazo.com/537b3fa4b5e6558279803ca60411055c

#任意課題
概念モデル
必要な情報の選定と管理すべき情報（エンティティと属性）と関係を整理したモデル
ER図が該当

論理モデルとは
概念モデルをリレーショナルデータモデルで取り扱いやすいように詳細化したモデル
→多対多の分解、キーの整理、正規化をしたもの

物理モデルとは
論理モデルをテーブルに落とし込むためにさらに詳細に表したモデル
→物理名の決定、型・制約の決定、インデックスの決定

このことを知るメリットは作業の順番が明確になること

データモデルの分類の参考：https://zenn.dev/umi_mori/books/331c0c9ef9e5f0/viewer/110b8e

#課題2
https://gyazo.com/580d4cc6a70f85d33f8c884757cccd66

#課題3
条件
1. 消費税改正が起きた場合
2. 大カテゴリー、小カテゴリー、メニュー自体などに変更があった場合
https://gyazo.com/dce84e05ffdfc6c69129635154882ba4

トリオの条件含む
追加条件
1. 複数店舗があった場合
2. 持ち帰れない商品と持ち変えられる商品を分けて表示したい場合
3. 顧客がネットで注文できるようにする場合（注文日時と受け渡し日時、注文の変更やキャンセル、論理削除）
https://gyazo.com/66a9a3222ecd78690890fca9130f266b

#課題4
お客さんが会計をする際の最終的な支払金額（税抜き）
SELECT order_id, sum(price * ordet_menu_quantity) as "税抜き合計" FROM praha_sushi.orders 
  inner join praha_sushi.order_menus Using(order_id)
  inner join praha_sushi.menus Using(menu_id) group by order_id;

お客さんが会計をする際の最終的な支払金額（税込）
SELECT order_id, FLOOR(sum(price * ordet_menu_quantity)*tax_rate) as "税込合計" FROM praha_sushi.orders
  inner join praha_sushi.taxes Using(tax_id)
  inner join praha_sushi.order_menus Using(order_id)
  inner join praha_sushi.menus Using(menu_id) group by order_id;

合計皿数
SELECT order_id, sum(ordet_menu_quantity) as "皿数合計" FROM praha_sushi.orders
  inner join praha_sushi.order_menus Using(order_id)
  inner join praha_sushi.menus Using(menu_id)
  inner join praha_sushi.genres Using(genre_id) 
  inner join praha_sushi.categories Using(category_id)
  where category_id = 2 group by order_id;

特定の期間内（今回は一ヶ月間）のお客さんの注文回数のランキング
SELECT customer_id, customer_name, count(*) FROM praha_sushi.orders ord 
  inner join praha_sushi.customers Using(customer_id)
  WHERE ordered_at BETWEEN '2022-11-01 00:00:00' AND '2022-11-30 23:59:59'
  group by customer_id order by count(*) desc;

各ジャンル毎の売上高（税抜き）
SELECT genre_name, sum(price * ordet_menu_quantity) as "売上高（税抜き）" FROM praha_sushi.orders
  inner join praha_sushi.order_menus Using(order_id)
  inner join praha_sushi.menus Using(menu_id)
  inner join praha_sushi.genres  Using(genre_id) 
  group by genre_id order by sum(price * ordet_menu_quantity) desc;

支払いが済んでいないお客さん一覧
SELECT customer_name, customer_phone FROM praha_sushi.orders
  inner join praha_sushi.customers Using(customer_id)
  where paid_exists = 0

docker の参考 https://qiita.com/moaikids/items/f7c0db2c98425094ef10
SQL文(CREATE DATABASE)の参考 https://qiita.com/ryosuketter/items/713c7046314ecdf1a4a9
csvファイルデータのインポートの参考 https://taiga.hatenadiary.com/entry/2018/02/11/181715
SQL文（LOAD DATA LOCAL INFILE）の参考 https://agohack.com/import-csv-files-load-data-local-infile/
SQL文（LOAD DATA LOCAL INFILE）の参考 https://yoku0825.blogspot.com/2018/02/load-data-infile.html
シェルスクリプト実行時の権限エラーの参考 https://qiita.com/kiririri/items/81a828befc54e188d776
外部キー制約に関しての参考 https://zenn.dev/praha/articles/2667cbb1ab7233

mysqlを使用するときは DBモデリング1 を current directory にした状態で docker-compose build --no-cache && docker-compose up をする
※ サンプルデータを入れ直したいときはdataの中身を削除してから
※ docker start でも良いが、mysql と phpmyadmin が別コンテナなので、両方起動する必要がある
phpmyadminのurlは localhost:8080
